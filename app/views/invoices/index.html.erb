<%= render partial: "layouts/sidebar" %>
<h1>Invoice history</h1>

<div class = "container-xl">
  <div class = "table-responsive pos">
    <div class = "table-wrapper">
      <div class = "table-title">
        <div class = "row">
          <div class = "col-sm-4">
            <h2>Subscription <b>Details</b></h2>
          </div>
        </div>
      </div>          
      <table class = "table table-striped table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>Customer</th>
            <th>Name</th>         
            <th>Reference id</th>           
            <th>Net Amount</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% num = 1 %>
          <% @user = User.find_by_id(session[:user_id]) %>
          <% @invoices.each do |invoice| %>
            <tr>
              <td><%= num %></td>
              <td>
                <% if @user.images.attached? %>
                  <%= image_tag @user.images.last, class: "rounded-circle dimensions2"%>
                <% else %>
                  <%= image_tag "default-profile-picture.jpg", class: "rounded-circle dimensions2" %>
                <% end %>
              </td>
              <td><%= @user.first_name %></td>                        
              <td>#<%= invoice.id %></td>
              <td>Rs. <%= invoice.amount %></td>
              <td><%= link_to "see invoice", show_invoice_path(invoice.id) %></td>
            </tr>
            <% num +=1 %>
          <% end %>
        </tbody>
      </table>      
    </div>
  </div>        
</div>
