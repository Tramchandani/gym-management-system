<%= render partial: "layouts/sidebar" %>
<div class="container">
  <div class="main-body">
    <div class="row gutters-sm">
      <div class="col-md-4 mb-3">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-column align-items-center text-center">                    
              <% if @user.images.attached? %>
                <%= image_tag @user.images.last, class: "rounded-circle dimensions"%>
              <% else %>
                <%= image_tag "default-profile-picture.jpg", class: "rounded-circle dimensions" %>
              <% end %>
              <div class="mt-3">
                <h4><%= @user.first_name %> <%= @user.last_name %></h4>
                <button class = "btn btn-sm btn-outline-primary"><%= link_to add_image_path(session[:user_id]) do %>
                    <i class = "glyphicon glyphicon-picture"></i> Add new photo
                  <% end %>
                </button>
              </div>
            </div>
          </div>
        </div> 
      </div>
      <div class="col-md-8">
        <div class="card mb-3">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-3">
                <h6 class="mb-0">Full Name</h6>
              </div>
              <div class="col-sm-9 text-secondary">
                <%= @user.first_name %> <%= @user.last_name %>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <h6 class="mb-0">Email</h6>
              </div>
              <div class="col-sm-9 text-secondary">
                <%= @user.email %>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <h6 class="mb-0">Date of Birth</h6>
              </div>
              <div class="col-sm-9 text-secondary">
                <%= @user.dob %>
              </div>
            </div>
            <hr>
            <% if @user.addresses.any? %>
              <% @user.addresses.each do |address| %>
                <% if address == @user.addresses.first %>
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0">Address</h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                      <p><%= address.house_number %>, <%= address.colony %> <%= address.street %> <%= address.city %>, <%= address.state %>
                        <%= link_to edit_address_path(address.id) do %>
                          <i class = "zmdi zmdi-border-color"></i>                              
                        <% end %>
                        <%= link_to address_path(address.id), method: :delete, data: { confirm: 'Are you sure?' } do %>
                          <i class = "zmdi zmdi-delete" ></i> 
                        <% end %>
                      </p>
                    </div>
                  </div>
                <% else %>
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0"></h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                      <p><%= address.house_number %>, <%= address.colony %> <%= address.street %> <%= address.city %>, <%= address.state %>
                        <%= link_to edit_address_path(address.id) do %>
                          <i class = "zmdi zmdi-border-color"> </i>                              
                        <% end %>
                        <%= link_to address_path(address.id), method: :delete, data: { confirm: 'Are you sure?' } do %>
                          <i class = "zmdi zmdi-delete" > </i> 
                        <% end %>
                      </p>
                    </div>
                  </div>
                <% end %>
              <% end %>
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0"></h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <%= link_to new_user_address_path(session[:user_id]) do %>
                    Add address
                  <% end %>
                </div>
              </div>
            <% else %>
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0">Address</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <%= link_to new_user_address_path(session[:user_id]) do %>
                    Add address
                  <% end %>
                </div>
              </div>
            <% end %>
            <div class="mt-3">
              <span class="float-right"><button class = "btn btn-sm btn-outline-primary"><%= link_to edit_user_path(session[:user_id]) do %>
                <i class = "glyphicon glyphicon-picture"></i> Edit Profile
                  <% end %>
                </button>
              </span>
            </div>
            <%= render partial: "layouts/show_notice" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
